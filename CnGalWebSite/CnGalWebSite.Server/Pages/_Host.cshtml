@page "/"
@using CnGalWebSite.Shared
@using CnGalWebSite.Shared.Component.Home
@using CnGalWebSite.DataModel.ViewModel.OperationRecords
@using Microsoft.AspNetCore.Authentication

@addTagHelper *, Microsoft.AspNetCore.Mvc.TagHelpers
@{
    Layout = "_Layout";
    var ip = Request.Headers["X-Forwarded-For"].FirstOrDefault();
    if (string.IsNullOrWhiteSpace(ip))
    {
        ip = Request.HttpContext.Connection.RemoteIpAddress.MapToIPv4().ToString();
    }
    var connectionInfo = new ConnectionInfo()
    {
        RemoteIpAddress = ip
    };

    var token = await HttpContext.GetTokenAsync("access_token").ConfigureAwait(false);
}

<component type="typeof(App)" render-mode="ServerPrerendered" param-ConnectionInfo="connectionInfo" param-Token="token" />
