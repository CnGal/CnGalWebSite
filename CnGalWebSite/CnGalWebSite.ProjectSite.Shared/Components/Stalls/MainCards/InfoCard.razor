@inject IUserService _userService
@implements IDisposable

<MDCard Class="stall-info-card mb-4 pa-4">
    <MDCard Outline Class="user-card on-background-text" Href="@($"/user/space/{Model.CreateUser.Id}/1")">
         <CnGalWebSite.Components.Images.MasaImage Src="@Model.CreateUser.Avatar" Alt="@Model.CreateUser.Name" Type="ImageType.Avatar" />
         <div class="name-card">
             <div class="title-medium">@(Model.CreateUser.OrganizationName ?? Model.CreateUser.Name)</div>
             <div class="label-large text-truncate-1">@(Model.CreateUser.OrganizationDescription)</div>
         </div>
     </MDCard>
     <div class="item-card">
         <div class="label-large">橱窗价格</div>
         <div class="title-large primary-text">@($"￥ {Model.Price}")</div>
     </div>
     <div class="item-card">
         <div class="label-large">截止日期</div>
         <div class="title-large primary-text">@Model.EndTime.ToString("yyyy-MM-dd")</div>
     </div>

       
    @if (_userService.UserInfo.Id == Model.CreateUser.Id)
    {
        <div class="action-card">
            <CnGalWebSite.Components.Buttons.MasaButton Icon="@IconType.Edit.ToIconString()" Text="编辑橱窗" Rounded Href="@($"/stall/edit/{Model.Id}")" />
         </div>
    }
</MDCard>

@code {
    [Parameter]
    public StallViewModel Model { get; set; }

    protected override void OnInitialized()
    {
        _userService.UserInfoChanged -= OnUserInfoChanged;
        _userService.UserInfoChanged += OnUserInfoChanged;
    }

    public void OnUserInfoChanged()
    {
        StateHasChanged();
    }

    public void Dispose()
    {
        _userService.UserInfoChanged -= OnUserInfoChanged;
        GC.SuppressFinalize(this);
    }
}
